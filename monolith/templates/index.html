{% extends 'homepage.html' %}
    {% block content %}
        {% if current_user.is_authenticated %}

            {% if current_user.is_operator %}

                {% for notification in notifications  %}
                    {% if not notification.already_read %}
                        {% if notification.operator_notification_type == 1 %}
                        <div class="alert alert-danger" role="alert">
                            <strong>
                                A customer that has been in your restaurant in the last 14 days is positive. <a href="/notifications/{{ notification.notification_id }}/mark_as_read" class="alert-link">Mark as read</a>
                            </strong>
                        </div>

                        {% else %}
                            <div class="alert alert-danger" role="alert">
                                <strong>
                                    The customer:
                                     <ul>
                                        <li> Email: {{ notification.user_positive_email }}</li>
                                        <li> Name: {{ notification.user_positive_name }}</li>
                                     </ul>
                                     <ul>
                                        Was marked Covid-19 positive. Please delete the reservation in date:
                                        <li> Datetime: {{ notification.user_booking_date.strftime('%d-%m-%Y') }}</li>
                                      </ul>
                                     <a href="/notifications/{{ notification.notification_id }}/mark_as_read" class="alert-link">Mark as read</a>
                                </strong>
                            </div>
                        {% endif %}
                    {% endif %}
                {% endfor %}

            {% else %}

                {% for notification in notifications %}
                    {% if not notification.already_read %}
                        {% if notification.customer_notification_type == 0 %}
                                <div class="alert alert-danger" role="alert">
                                <strong> You have had contact with a Covid-19 positive in the last 14 days.
                                     <a href="/notifications/{{ notification.notification_id }}/mark_as_read" class="alert-link">Mark as read</a>
                                </strong>
                                </div>
                            {% else %}
                                <div class="alert alert-danger" role="alert">
                                <strong> The restaurant {{ notification.rest_closed_name }} has closed.
                                    Your reservation for day {{ notification.user_booking_date.strftime('%d-%m-%Y') }} has been canceled.
                                     <a href="/notifications/{{ notification.notification_id }}/mark_as_read" class="alert-link">Mark as read</a>
                                </strong>
                                 </div>
                            {% endif %}
                    {% endif %}
                {% endfor %}

            {% endif %}


            <h3>Welcome back {{ current_user.firstname }}!</h3>

          {% if current_user.is_operator %}
            <br>
            <h3>Your Restaurant:</h3>
            {% for restaurant in restaurants %}
              <div>
                <h5>
                  <li>
                       <a href="/restaurants/{{ restaurant.id }}"> {{restaurant.name}}  </a>
                         {% if restaurant.likes is none %}
                            has No Likes
                         {% else %}
                            has {{restaurant.likes}} Likes
                         {% endif %}
                  </li>   
                </h5>
              </div>
                <br>
                  <a class="btn btn-outline-secondary btn-sm"  href="/restaurants/{{ restaurant.id }}/overview"> Reservations overview  </a>
                  <a class="btn btn-outline-secondary btn-sm"  href="/restaurants/{{ restaurant.id }}/reservations/today"> Today's Reservations  </a>
                  <a class="btn btn-outline-secondary btn-sm"  href="/restaurants/{{ restaurant.id }}/reservations"> Search Reservations  </a>
                  <a class="btn btn-outline-secondary btn-sm"  href="/restaurants/{{ restaurant.id }}/edit"> Edit Restaurant  </a>
            {% endfor %}
          {% endif %}

        {% else %}
            <h2>Welcome to GoOutSafe</h2>
          Hi Anonymous, if you already have an account <a href="/login">Log in</a>
            <p></p>
            Otherwise:
            <ul>
                <li><a href="/create_user">Sign up as Customer</a> </li>
                <li><a href="/create_operator">Sign up as Restaurant's Operator</a> </li>
            </ul>

        {% endif %}
    {% endblock %}